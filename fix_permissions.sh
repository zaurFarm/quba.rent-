#!/bin/bash

# Этот скрипт нужно выполнить на сервере через SSH
# Команда: ssh -p 19872 www-data@95.216.232.219 "bash -s" < fix_permissions.sh

echo "Исправление прав доступа для сайта quba.rent..."
echo ""

# Переходим в директорию сайта
cd /var/www/html

# Устанавливаем правильные права на файлы
echo "1. Установка прав на файлы (644)..."
find . -type f -exec chmod 644 {} \;

# Устанавливаем правильные права на директории
echo "2. Установка прав на директории (755)..."
find . -type d -exec chmod 755 {} \;

# Проверяем владельца файлов
echo "3. Проверка владельца файлов..."
ls -la | head -20

# Перезапускаем nginx для применения изменений
echo ""
echo "4. Перезапуск nginx..."
sudo systemctl restart nginx || service nginx restart

echo ""
echo "Готово! Теперь сайт должен работать."
echo "Проверьте доступность: http://95.216.232.219/html/"
